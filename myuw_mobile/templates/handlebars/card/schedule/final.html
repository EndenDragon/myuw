{% load templatetag_handlebars %}
    {% tplhandlebars "final_exam_schedule_card_content" %}

    <h4>Final Exam Schedule</h4>

    {{#if is_summer}}
        <div class="alert alert-info">
            Unlike Autumn, Winter and Spring quarters, the Summer quarter does not have a week set aside exclusively for final examinations. Most Summer quarter final examinations are given on the final meeting day of the course. Consult with your instructor on when your final examination will be given.
        </div>
    {{else}}

        {{#if visual_data.latest_ending}}
        {{#with visual_data}}
        <div class="row-fluid">
            <div class="span12">
                <div id="final-visual-schedule" class="visual-schedule {{schedule_hours_class}}" >
			
                    <div class="exam-time-bar exam-day-col2 hours-{{total_hours}} clearfix ">
                        {{#each display_hours}}
                            <div class="hour-label" style="position:absolute;top:{{time_percentage position ../start_time ../end_time }}%;"><p>{{format_schedule_hour hour}}</p>
                            </div>
                        {{/each}}
                    </div>

                    {{#if has_7_days}}
                        <div class="seven-day">
                            <div class="day-label">SAT <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 6}}</span></div>
                            <div class="exam-day-col hours-{{total_hours}}">
                                {{ show_final_card_day saturday start_time end_time ../term}}
                            </div>
                        </div>

                        <div class="seven-day">
                            <div class="day-label">SUN <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 5}}</span></div>
                            <div class="exam-day-col hours-{{total_hours}}">
                                {{ show_final_card_day sunday start_time end_time ../term}}
                            </div>
                        </div>
                    {{/if}}

                    <div {{#if has_7_days}}class="seven-day"{{else}}class="five-day"{{/if}}>
                        <div class="day-label">MON <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 4}}</span></div>
                        <div class="exam-day-col hours-{{total_hours}}">
                            {{ show_final_card_day monday start_time end_time ../term}}
                        </div>
                    </div>

                    <div {{#if has_7_days}}class="seven-day"{{else}}class="five-day"{{/if}}>
                        <div class="day-label">TUE <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 3}}</span></div>
                        <div class="exam-day-col hours-{{total_hours}}">
                            {{ show_final_card_day tuesday start_time end_time ../term}}
                        </div>
                    </div>

                    <div {{#if has_7_days}}class="seven-day"{{else}}class="five-day"{{/if}}>
                        <div class="day-label">WED <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 2}}</span></div>
                        <div class="exam-day-col hours-{{total_hours}}">
                            {{ show_final_card_day wednesday start_time end_time ../term}}
                        </div>
                    </div>

                    <div {{#if has_7_days}}class="seven-day"{{else}}class="five-day"{{/if}}>
                        <div class="day-label">THU <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 1}}</span></div>
                        <div class="exam-day-col hours-{{total_hours}}">
                            {{ show_final_card_day thursday start_time end_time ../term}}
                        </div>
                    </div>

                    <div {{#if has_7_days}}class="seven-day"{{else}}class="five-day"{{/if}}>
                        <div class="day-label">FRI <br /> <span class="final-date">{{ formatDateAsFinalsDay end_date 0}}</span></div>
                        <div class="exam-day-col hours-{{total_hours}}">
                            {{ show_final_card_day friday start_time end_time ../term}}
                        </div>
                    </div>
                </div>
            </div>
        {{/with}}
        {{/if}}

        {{#if over_one_week}}
        {{#each over_one_week}}
            <div class="fallback-exams-list">
                <div class="c{{color_id}} c{{color_id}}Border">
            	    <h3>{{ curriculum_abbr }} {{course_number}}{{section_id}}</h3>
                </div>
            
                <div class="fallback-exams-details">
		    <dl class="dl-horizontal">
                        <dt>Date</dt>
                        <dd>{{ formatDateAsDate final_exam.start_date }}</dd>
                        <dt>Time</dt>
                        <dd>{{ formatDateAsTimeAMPM final_exam.start_date }}-{{ formatDateAsTimeAMPM final_exam.end_date }}</dd>               
                        <dt>Location</dt>
                        <dd>
                            {{#if final_exam.latitude}}
                            <a href="http://maps.google.com/maps?q={{ final_exam.latitude }},{{ final_exam.longitude }}+({{encodeForMaps final_exam.building_name }})&z=18" target="_blank" class="show_map_modal" rel="{{final_exam.building_name}}">
                            {{/if}}
                            {{#if final_exam.building_tbd}}
                            Room TBD
                            {{else}}
                            {{ final_exam.building }} {{ final_exam.room_number }}
                            {{/if}}
                            {{#if final_exam.latitude}}</a>{{/if}}
                        </dd>
      		        <dt>Status</dt>
      		        <dd>
                            {{#if final_exam.is_confirmed }}
                            Confirmed
                            {{else}}
                            Not confirmed
                            {{/if}}
                        </dd>

                        {{#if instructors}}
      		        <dt>Instructor</dt>
      		        <dd>  
      			    <ul>
                                {{#each instructors}}
                                {{#if whitepages_publish}}
                                <li><a href="javascript:void(0);" class="instructor" rel="{{uwregid}}">{{full_name}}</a></li>
                                {{else}}
                                <li>{{full_name}}</li>
                                {{/if}}
                                {{/each}}
                            </ul>
                        </dd>
                        {{/if}}
                    </dl>
                </div>          
            </div>
        {{/each}}
        {{/if}}

        <!-- begin - if there are meetings with times to be arranged -->
        {{#if tbd}}
        <div class="courseTBD">
            <h6>Courses with final exam meeting times to be determined or courses with no final exam:</h6>
            {{#each tbd}}
            <div class="c{{color_id}} visual-course pull-left">
                <div class="visual-course-id">{{ curriculum_abbr }} {{course_number}}{{section_id}}</div> 
            </div>
            {{/each}}
        </div>
        {{/if}}
        <!-- end - if there are meetings with times to be arranged -->
    {{/if}}

{% endtplhandlebars %}
