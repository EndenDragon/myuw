{% load templatetag_handlebars %}
{% tplhandlebars "request_email_lists_tmpl" %}

<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

            <h4>Create Mailing List</h4>
        </div>

        <div class="modal-body">

            {{#if request_sent }}
            <div class="">
                <h3>Request submitted</h3>
                <ul class="">
                    <li>An email confirmation will be sent to {{ user.netid }}@uw.edu</li>
                    <li>Mailing lists may take up to 24 hours to activate</li>
                </ul>
                <p><a href="https://itconnect.uw.edu/connect/email/resources/mailman/" target="_blank">Learn more about Mailman email list manager</a></p>
            </div>
            {{else}}

            <div>{{ course_abbr }} {{course_number}} {{section_id}}</div>
            <div>{{ capitalizeString quarter }} {{ year }}</div>

            <ul class="">
                <li>Creates a single list for this section: {{section_list.list_address}}@uw.edu</li>
                <li>Stays synced with the official class list</li>
            </ul>

            <form role="form" id="request_emaillist_form" method="POST">{% csrf_token %}
                <div>
                    <button type="submit" class="btn btn-default" form="request_emaillist_form" value="Create Mailing Lists">Create Mailing Lists</button>
                </div>

                {{#unless section_list.list_exists}}
                <div class="section_single">
                    <input type="hidden" id="section_single_{{section_list.section_id}}" name="section_single_{{section_list.section_id}}" value="{{section_list.section_label}}"/>
                </div>
                {{/unless}}
                
                {{#if is_primary}}
                {{#if has_multi_secondaries }}
                <div>
                    <p>Creates multiple email lists, one for each secondary section selected</p>
                    <fieldset>
                        <div>
                            <label>Select all</label> <input type="checkbox"/>
                        </div>
                        <ul>
                            {{#each secondary_section_lists}}
                            <li class="secondary_single">
                                {{#unless list_exists}}
                                <label for="secondary_single_{{ list_address }}">
                                    {{../../course_abbr}} {{../../course_number}} {{section_id}}
                                </label>
                                <input type="checkbox" id="secondary_single_{{section_id}}" name="secondary_single_{{section_id}}" value="{{section_label}}" />
                                {{else}}
                                <span>{{../../course_abbr}} {{../../course_number}} {{section_id}} list already exists: {{list_address}}@uw.edu</span>
                                {{/unless}}
                            </li>
                            {{/each}}
                        </ul>
                    </fieldset>
                </div>
                {{/if}}
                {{/if}}
            </form>

            {{/if}}
            
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
    </div>
</div>

{% endtplhandlebars %}
